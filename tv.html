<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Starship Cinema | Cloud Stream</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        body { margin: 0; background: #000; color: white; font-family: 'Inter', sans-serif; overflow: hidden; }
        .cinema-overlay {
            position: fixed; inset: 0; background: radial-gradient(circle at center, #1a0033 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        #video-container { 
            width: 90%; max-width: 1000px; aspect-ratio: 16/9; 
            background: #050505; border-radius: 20px; 
            box-shadow: 0 0 50px rgba(138, 43, 226, 0.4); 
            overflow: hidden; position: relative; border: 1px solid rgba(174, 84, 255, 0.2); 
        }
        iframe { width: 100%; height: 100%; border: none; }
        .controls { margin-top: 25px; display: flex; gap: 15px; }
        .btn-cinema { 
            background: rgba(138, 43, 226, 0.1); border: 1px solid #ae54ff; 
            padding: 12px 28px; border-radius: 30px; cursor: pointer; 
            transition: 0.3s; display: flex; align-items: center; gap: 10px; 
            font-weight: 800; text-transform: uppercase; font-size: 12px;
            letter-spacing: 1px; color: #ae54ff;
        }
        .btn-cinema:hover { background: #8a2be2; color: white; box-shadow: 0 0 20px #8a2be2; }
    </style>
</head>
<body>

    <div class="cinema-overlay">
        <div id="video-container">
            <div id="placeholder" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #444;">
                <i class="material-icons-round" style="font-size: 100px; margin-bottom: 15px; color: #1a0033;">movie_filter</i>
                <p style="font-size: 14px; letter-spacing: 2px;">SECURE CLOUD STREAMING ACTIVE</p>
            </div>
            <iframe id="player" src="" style="display: none;" allow="autoplay; fullscreen"></iframe>
        </div>

        <div class="controls">
            <button class="btn-cinema" onclick="openPicker()">
                <i class="material-icons-round">cloud_download</i> Browse Cloud Cinema
            </button>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        let pickerApiLoaded = false;
        // YOUR SECURE CREDENTIALS
        const API_KEY = 'AIzaSyDQmlHngYNWqAbveDkUCiuIdgN1ZnnZ2ng';
        const CLIENT_ID = '106130595767-hlvoakq65984eu1fc9mq0h3951oll8qs.apps.googleusercontent.com';

        // Initialize GAPI and Picker
        function onApiLoad() {
            gapi.load('picker', { 'callback': () => { pickerApiLoaded = true; } });
        }

        function openPicker() {
            const oauthToken = window.parent.Kernel.DRIVE_ACCESS_TOKEN;

            if (!oauthToken) {
                window.parent.Kernel.notify("ERROR: System not linked to Cloud. Click blue icon in Dock.");
                return;
            }

            if (pickerApiLoaded) {
                const view = new google.picker.View(google.picker.ViewId.DOCS);
                view.setMimeTypes("video/mp4,video/x-matroska,video/webm,video/quicktime");

                const picker = new google.picker.PickerBuilder()
                    .addView(view)
                    .setOAuthToken(oauthToken)
                    .setDeveloperKey(API_KEY)
                    .setCallback(pickerCallback)
                    .setOrigin("https://619amandagaiser-del.github.io")
                    .build();
                picker.setVisible(true);
            }
        }

        function pickerCallback(data) {
            if (data.action === google.picker.Action.PICKED) {
                const doc = data[google.picker.Response.DOCUMENTS][0];
                const fileId = doc[google.picker.Document.ID];
                
                // Set the player to the Drive Preview URL
                const streamUrl = `https://drive.google.com/file/d/${fileId}/preview`;
                
                document.getElementById('placeholder').style.display = 'none';
                const player = document.getElementById('player');
                player.src = streamUrl;
                player.style.display = 'block';
                
                window.parent.Kernel.notify("CINEMA: Now Streaming " + doc[google.picker.Document.NAME]);
            }
        }

        window.onload = onApiLoad;
    </script>
</body>
</html>
