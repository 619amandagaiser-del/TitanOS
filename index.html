
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TITAN OS | LEGACY_SINGULARITY v13</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        :root { --accent: #ff0055; --bg: #030305; --glass: rgba(10, 10, 15, 0.9); }
        body { background: var(--bg); color: white; font-family: 'JetBrains Mono', monospace; overflow: hidden; height: 100vh; margin: 0; perspective: 1500px; }
        
        #kernel-canvas { position: fixed; inset: 0; z-index: 0; }
        
        /* THE WINDOWS */
        .win { 
            position: absolute; background: var(--glass); border: 1px solid rgba(255, 0, 85, 0.3);
            backdrop-filter: blur(30px); border-radius: 4px; display: none; flex-direction: column;
            box-shadow: 0 40px 80px rgba(0,0,0,0.9); transform-style: preserve-3d;
        }
        .win.active { display: flex; }
        .win-head { background: rgba(255, 0, 85, 0.1); padding: 8px 12px; cursor: move; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,0,85,0.2); }
        .win-body { flex: 1; overflow: auto; padding: 15px; font-size: 11px; }

        /* THE CINEMA */
        #cinema-screen { background: #000; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; border: 2px solid #222; position: relative; }
        .cinema-glow { position: absolute; inset: 0; box-shadow: inset 0 0 50px rgba(255,0,85,0.2); pointer-events: none; }

        /* DOCK */
        #dock { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.9); border: 1px solid var(--accent);
            padding: 8px 20px; border-radius: 4px; display: flex; gap: 20px; z-index: 10000;
        }
        .icon { font-size: 24px; cursor: pointer; color: var(--accent); opacity: 0.6; transition: 0.3s; }
        .icon:hover { opacity: 1; transform: scale(1.2) translateY(-5px); }
    </style>
</head>
<body onclick="AudioKernel.start()">

    <canvas id="kernel-canvas"></canvas>

    <div id="win-proxy" class="win" style="width: 700px; height: 500px; top: 50px; left: 50px;">
        <div class="win-head" onmousedown="UI.drag(event, 'win-proxy')">
            <span class="flex items-center gap-2"><i class="material-icons-round text-sm">public</i> NETGATE_PROXY_v4</span>
            <button onclick="UI.close('win-proxy')">×</button>
        </div>
        <div class="win-body flex flex-col p-0">
            <div class="bg-zinc-900 p-2 flex gap-2">
                <input id="proxy-url" class="bg-black border border-white/10 flex-1 px-3 py-1 outline-none text-[var(--accent)]" value="https://titan.network/nodes">
                <button onclick="Proxy.load()" class="bg-[var(--accent)] text-black px-4 font-bold text-[10px]">ROUTE</button>
            </div>
            <div id="proxy-viewport" class="flex-1 bg-white text-black p-4 font-serif overflow-auto">
                <h1 class="text-2xl font-bold mb-4">Titan Proxy Node #104</h1>
                <p>Establishing encrypted tunnel...</p>
                <div class="mt-4 p-4 border-2 border-dashed border-zinc-300 bg-zinc-50">
                    [SECURE_CONTENT_BLOCK] - Simulated routing active.
                </div>
            </div>
        </div>
    </div>

    <div id="win-cinema" class="win" style="width: 600px; height: 420px; top: 150px; left: 600px;">
        <div class="win-head" onmousedown="UI.drag(event, 'win-cinema')">
            <span class="flex items-center gap-2"><i class="material-icons-round text-sm">movie</i> TITAN_CINEMA</span>
            <button onclick="UI.close('win-cinema')">×</button>
        </div>
        <div class="win-body">
            <div id="cinema-screen">
                <div class="cinema-glow"></div>
                <i class="material-icons-round text-6xl opacity-20">play_circle_filled</i>
                <div class="absolute bottom-4 left-4 text-[9px] text-zinc-500">DECODING_STREAM: 0.00%</div>
            </div>
            <div class="mt-4 flex flex-col gap-2">
                <input class="bg-transparent border-b border-white/20 p-1 text-[10px] outline-none" placeholder="Enter .mp4 or Stream URL...">
                <div class="flex gap-4">
                    <button class="text-[10px] hover:text-[var(--accent)]">▶ PLAY</button>
                    <button class="text-[10px] hover:text-[var(--accent)]">■ STOP</button>
                </div>
            </div>
        </div>
    </div>

    <div id="win-mem" class="win" style="width: 300px; height: 300px; top: 400px; left: 150px;">
        <div class="win-head" onmousedown="UI.drag(event, 'win-mem')">
            <span class="flex items-center gap-2"><i class="material-icons-round text-sm">bubble_chart</i> HEAP_FLOW</span>
            <button onclick="UI.close('win-mem')">×</button>
        </div>
        <div class="win-body flex items-center justify-center">
            <canvas id="mem-canvas" width="250" height="200"></canvas>
        </div>
    </div>

    <div id="dock">
        <div class="icon" onclick="UI.open('win-proxy')"><i class="material-icons-round">public</i></div>
        <div class="icon" onclick="UI.open('win-cinema')"><i class="material-icons-round">movie</i></div>
        <div class="icon" onclick="UI.open('win-mem')"><i class="material-icons-round">bubble_chart</i></div>
        <div class="icon" onclick="location.reload()"><i class="material-icons-round">power_settings_new</i></div>
    </div>

    <script>
        const AudioKernel = {
            ctx: null,
            start() { if(!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); },
            beep(f, d=0.1) {
                if(!this.ctx) return;
                const o = this.ctx.createOscillator();
                const g = this.ctx.createGain();
                o.connect(g); g.connect(this.ctx.destination);
                o.frequency.value = f;
                g.gain.exponentialRampToValueAtTime(0.0001, this.ctx.currentTime + d);
                o.start(); o.stop(this.ctx.currentTime + d);
            }
        };

        const Proxy = {
            load() {
                const url = document.getElementById('proxy-url').value;
                const vp = document.getElementById('proxy-viewport');
                vp.innerHTML = `<div class="animate-pulse">Requesting header from ${url}...</div>`;
                setTimeout(() => {
                    vp.innerHTML = `
                        <h2 class="text-xl font-black text-red-600">403 ACCESS_RESTRICTED</h2>
                        <p class="mt-2 text-sm text-zinc-600">The Titan Hypervisor has intercepted this request. External traffic is filtered through the Neural Sandbox.</p>
                        <ul class="mt-4 list-disc list-inside text-xs opacity-50">
                            <li>IP_MASK: ACTIVE</li>
                            <li>DNS_POISON_PROTECTION: ON</li>
                            <li>PROTOCOL: TITAN_SECURE</li>
                        </ul>
                    `;
                    AudioKernel.beep(200, 0.5);
                }, 1500);
            }
        };

        const UI = {
            open(id) { 
                document.getElementById(id).classList.add('active'); 
                document.getElementById(id).style.zIndex = Date.now();
                AudioKernel.beep(600, 0.1);
            },
            close(id) { document.getElementById(id).classList.remove('active'); },
            drag(e, id) {
                const el = document.getElementById(id);
                el.style.zIndex = Date.now();
                const ox = e.clientX - el.offsetLeft;
                const oy = e.clientY - el.offsetTop;
                document.onmousemove = (ev) => {
                    el.style.left = (ev.clientX - ox) + 'px';
                    el.style.top = (ev.clientY - oy) + 'px';
                    // Suble 3D tilt
                    const rx = (ev.clientY - window.innerHeight/2) / 50;
                    const ry = (ev.clientX - window.innerWidth/2) / 50;
                    el.style.transform = `rotateX(${-rx}deg) rotateY(${ry}deg)`;
                };
                document.onmouseup = () => {
                    document.onmousemove = null;
                    el.style.transform = `rotateX(0deg) rotateY(0deg)`;
                };
            }
        };

        // MEMORY BUBBLES
        function initMemCanvas() {
            const mc = document.getElementById('mem-canvas');
            const mctx = mc.getContext('2d');
            let spheres = Array(5).fill().map(() => ({ x: 125, y: 100, r: 10+Math.random()*20, vx: Math.random()-0.5, vy: Math.random()-0.5 }));

            function draw() {
                mctx.clearRect(0,0,250,200);
                spheres.forEach(s => {
                    s.x += s.vx; s.y += s.vy;
                    if(s.x < s.r || s.x > 250-s.r) s.vx *= -1;
                    if(s.y < s.r || s.y > 200-s.r) s.vy *= -1;
                    
                    mctx.beginPath();
                    const g = mctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r);
                    g.addColorStop(0, '#ff0055'); g.addColorStop(1, 'transparent');
                    mctx.fillStyle = g;
                    mctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
                    mctx.fill();
                });
                requestAnimationFrame(draw);
            }
            draw();
        }

        // KERNEL SHADER (Starfield)
        function initKernel() {
            const c = document.getElementById('kernel-canvas');
            const ctx = c.getContext('2d');
            c.width = window.innerWidth; c.height = window.innerHeight;
            const stars = Array(200).fill().map(() => ({ x: Math.random()*c.width, y: Math.random()*c.height, z: Math.random()*c.width }));

            function loop() {
                ctx.fillStyle = 'black'; ctx.fillRect(0,0,c.width,c.height);
                ctx.fillStyle = 'white';
                stars.forEach(s => {
                    s.z -= 2;
                    if(s.z <= 0) s.z = c.width;
                    const x = (s.x - c.width/2) * (c.width/s.z) + c.width/2;
                    const y = (s.y - c.height/2) * (c.width/s.z) + c.height/2;
                    const r = (1 - s.z/c.width) * 3;
                    ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2); ctx.fill();
                });
                requestAnimationFrame(loop);
            }
            loop();
        }

        window.onload = () => {
            initKernel();
            initMemCanvas();
            UI.open('win-proxy');
        };
    </script>
</body>
</html>
