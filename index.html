<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shadow | Dashboard</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --primary: #38bdf8; --bg: #0b0f1a; --card: #161b2a; }
        body, html { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; height: 100vh; overflow: hidden; }
        
        /* Central UI Layout */
        #main-ui { display: flex; align-items: center; justify-content: center; height: 100%; flex-direction: column; }
        .container { background: var(--card); padding: 3.5rem; border-radius: 24px; text-align: center; width: 450px; border: 1px solid #2d3748; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
        
        h1 { font-size: 4rem; margin: 0; background: linear-gradient(to bottom, #fff, #38bdf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: -2px; font-weight: 900; }
        p { color: #64748b; margin-top: -5px; margin-bottom: 2.5rem; font-size: 0.9rem; letter-spacing: 1px; }
        
        input { width: 100%; padding: 16px; margin-bottom: 1.2rem; border-radius: 12px; border: 1px solid #2d3748; background: #0b0f1a; color: white; box-sizing: border-box; outline: none; transition: 0.3s; font-size: 1rem; }
        input:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(56, 189, 248, 0.2); }
        
        .launch-btn { width: 100%; padding: 16px; background: var(--primary); color: #0b0f1a; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; text-transform: uppercase; font-size: 1rem; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .launch-btn:hover { transform: translateY(-2px); background: #7dd3fc; }
        
        .cloak-link { margin-top: 1.5rem; color: #475569; font-size: 0.75rem; cursor: pointer; text-decoration: none; border: none; background: none; transition: 0.3s; }
        .cloak-link:hover { color: var(--primary); }

        /* Fullscreen Content Viewer */
        #viewer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: none; z-index: 9999; }
    </style>
</head>
<body>

    <div id="main-ui">
        <div class="container">
            <h1>Shadow</h1>
            <p>ADVANCED WEB TUNNEL</p>
            
            <input type="text" id="target" placeholder="Enter Destination URL..." onkeypress="if(event.key==='Enter') launch()">
            
            <button class="launch-btn" onclick="launch()">
                Launch Tunnel <span>â†’</span>
            </button>
            
            <button class="cloak-link" onclick="cloak()">Run in About:Blank Mode</button>
        </div>
    </div>

    <div id="viewer"></div>

    <script>
        // PANIC KEY: Press Escape to instantly switch to Google Classroom
        document.addEventListener('keydown', (e) => {
            if (e.key === "Escape") {
                window.location.replace("https://classroom.google.com");
            }
        });

        // CLOAK MODE
        function cloak() {
            const win = window.open();
            if (!win) {
                alert("Please allow popups for Stealth Mode!");
                return;
            }
            const url = window.location.href;
            win.document.body.style.margin = "0";
            win.document.body.style.height = "100vh";
            win.document.body.innerHTML = `<iframe src="${url}" style="border:none;width:100%;height:100%;margin:0;"></iframe>`;
            window.location.replace("https://google.com"); 
        }

        // PROXY ENGINE
        async function launch() {
            const target = document.getElementById('target').value;
            if (!target) return;

            const btn = document.querySelector('.launch-btn');
            btn.innerHTML = "Opening Tunnel...";
            btn.style.opacity = "0.7";

            try {
                const resp = await puter.net.fetch(target);
                let html = await resp.text();

                // Inject base tag for assets
                const base = `<base href="${target}">`;
                html = html.includes('<head>') ? html.replace('<head>', `<head>${base}`) : base + html;

                // Switch to viewer
                document.getElementById('main-ui').style.display = 'none';
                const viewer = document.getElementById('viewer');
                viewer.style.display = 'block';
                viewer.innerHTML = html;

                // Execute scripts manually
                document.querySelectorAll("script").forEach(s => {
                    const newS = document.createElement("script");
                    newS.text = s.text;
                    document.head.appendChild(newS).parentNode.removeChild(newS);
                });
            } catch (e) {
                alert("Error connecting. Try a different URL.");
                location.reload();
            }
        }
    </script>
</body>
</html>
