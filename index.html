<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starship OS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* STARSHIP THEME INTEGRATION */
        :root { 
            --bg: #050505; 
            --accent: #8a2be2; /* Matches your TV.html */
            --win-bg: #120032; /* Matches your Start.html */
            --text: #eee;
        }
        body { 
            background: radial-gradient(circle at top left, #120032 0%, #000000 90%); /* Your Starship Gradient */
            color: var(--text); 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            height: 100vh; 
            user-select: none; 
        }

        /* DYNAMIC WINDOW SYSTEM */
        #desktop { position: absolute; inset: 0; z-index: 1; pointer-events: none; }
        .window { 
            position: absolute; 
            background: #0d0d14; 
            border: 1px solid rgba(138, 43, 226, 0.3); /* Purple border */
            border-radius: 12px; 
            display: flex; 
            flex-direction: column; 
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.1); 
            overflow: hidden; 
            min-width: 320px; 
            min-height: 200px; 
            pointer-events: auto;
            transition: opacity 0.2s, transform 0.2s;
        }
        .win-bar { 
            height: 36px; 
            background: linear-gradient(90deg, #1a1f4a, #0b0f2e); /* Matches Profile.html */
            display: flex; 
            align-items: center; 
            padding: 0 12px; 
            cursor: grab; 
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .win-bar:active { cursor: grabbing; }
        .win-title { font-size: 11px; font-weight: 900; letter-spacing: 1px; color: #a78bfa; flex-grow: 1; text-transform: uppercase; }
        .win-controls { display: flex; gap: 8px; }
        .win-btn { width: 10px; height: 10px; border-radius: 50%; cursor: pointer; opacity: 0.8; }
        .win-btn:hover { opacity: 1; }
        .close-btn { background: #ef4444; } .max-btn { background: #f59e0b; } .min-btn { background: #10b981; }
        
        .win-content { flex-grow: 1; position: relative; background: #000; }
        iframe { width: 100%; height: 100%; border: none; background: #0b0f2e; }

        /* DRAG SHIELD (Fixes the "Broken UI" when dragging over iframes) */
        .drag-shield { position: absolute; inset: 0; z-index: 50; display: none; }
        .window.dragging .drag-shield { display: block; }

        /* THE DOCK */
        #dock { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
            height: 64px; 
            background: rgba(18, 0, 50, 0.7); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255,255,255,0.1); 
            border-radius: 24px; 
            display: flex; align-items: center; padding: 0 20px; gap: 10px; 
            z-index: 9000; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .dock-icon { 
            width: 48px; height: 48px; 
            border-radius: 14px; 
            display: flex; align-items: center; justify-content: center; 
            cursor: pointer; transition: 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            position: relative;
        }
        .dock-icon:hover { transform: translateY(-10px) scale(1.1); background: rgba(255,255,255,0.1); }
        .dock-icon i { font-size: 28px; color: #fff; }
        .dock-tooltip { 
            position: absolute; top: -35px; background: #000; color: white; 
            padding: 4px 8px; border-radius: 6px; font-size: 10px; opacity: 0; 
            pointer-events: none; transition: 0.2s; white-space: nowrap;
        }
        .dock-icon:hover .dock-tooltip { opacity: 1; top: -45px; }

        /* APP DRAWER (The 51 Features) */
        #app-drawer { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9); 
            width: 700px; height: 500px; 
            background: rgba(13, 13, 20, 0.95); 
            border-radius: 20px; 
            border: 1px solid rgba(138, 43, 226, 0.3);
            display: grid; grid-template-columns: repeat(6, 1fr); 
            padding: 30px; gap: 15px; 
            z-index: 8000; opacity: 0; pointer-events: none; transition: 0.2s;
        }
        #app-drawer.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        .drawer-item { display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; padding: 10px; border-radius: 8px; }
        .drawer-item:hover { background: rgba(255,255,255,0.1); }
        
        /* PANIC */
        #panic-layer { position: fixed; inset: 0; background: #fff; z-index: 999999; display: none; }
    </style>
</head>
<body onload="OS.boot()">

    <div id="panic-layer"><iframe src="https://classroom.google.com" style="width:100%;height:100%;border:none;"></iframe></div>

    <div id="desktop"></div>

    <div id="dock">
        <div class="dock-icon" onclick="OS.toggleDrawer()">
            <i class="material-icons-round" style="color:#fff;">grid_view</i>
            <span class="dock-tooltip">All Apps</span>
        </div>
        <div style="width:1px; height:24px; background:rgba(255,255,255,0.2); margin:0 5px;"></div>
        
        <div class="dock-icon" onclick="OS.open('home')">
            <i class="material-icons-round" style="color:#8a2be2;">rocket_launch</i>
            <span class="dock-tooltip">Starship Dashboard</span>
        </div>
        <div class="dock-icon" onclick="OS.open('tv')">
            <i class="material-icons-round" style="color:#c084fc;">live_tv</i>
            <span class="dock-tooltip">Star TV</span>
        </div>
        <div class="dock-icon" onclick="OS.open('profile')">
            <i class="material-icons-round" style="color:#4ade80;">account_circle</i>
            <span class="dock-tooltip">Profile</span>
        </div>
        
        <div style="width:1px; height:24px; background:rgba(255,255,255,0.2); margin:0 5px;"></div>
        
        <div class="dock-icon" onclick="OS.open('discord')">
            <i class="material-icons-round" style="color:#5865F2;">discord</i>
            <span class="dock-tooltip">Discord</span>
        </div>
        <div class="dock-icon" onclick="OS.open('browser')">
            <i class="material-icons-round" style="color:#3b82f6;">public</i>
            <span class="dock-tooltip">Tunnel</span>
        </div>
    </div>

    <div id="app-drawer">
        </div>

    <template id="win-temp">
        <div class="window">
            <div class="win-bar">
                <div class="win-title">Title</div>
                <div class="win-controls">
                    <div class="win-btn min-btn"></div>
                    <div class="win-btn max-btn"></div>
                    <div class="win-btn close-btn"></div>
                </div>
            </div>
            <div class="win-content">
                <div class="drag-shield"></div>
            </div>
        </div>
    </template>

    <script>
        const OS = {
            zIndex: 100,
            // THIS MAPS YOUR FILES TO THE OS
            apps: {
                'home': { title: 'Starship Dashboard', url: 'start.html', icon: 'rocket_launch', color: '#8a2be2' },
                'tv': { title: 'Star TV', url: 'tv.html', icon: 'live_tv', color: '#c084fc' },
                'profile': { title: 'User Profile', url: 'profile.html', icon: 'account_circle', color: '#4ade80' },
                
                // EXTRAS
                'discord': { title: 'Discord', url: 'https://discord.com/app', icon: 'discord', color: '#5865F2' },
                'browser': { title: 'Titan Tunnel', url: 'https://www.google.com/search?igu=1', icon: 'public', color: '#3b82f6' },
                'roblox': { title: 'Roblox Cloud', url: 'https://www.easyfun.gg/embed/roblox.html?start=1', icon: 'sports_esports', color: '#ef4444' },
                'spotify': { title: 'Spotify', url: 'https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M', icon: 'library_music', color: '#1db954' },
                'calc': { title: 'Calculator', type: 'widget', code: 'calc', icon: 'calculate', color: '#f59e0b' },
                'todo': { title: 'Tasks', type: 'widget', code: 'todo', icon: 'check_circle', color: '#06b6d4' }
            },

            boot() {
                this.renderDrawer();
                document.addEventListener('keydown', e => { 
                    if(e.key === '`') document.getElementById('panic-layer').style.display = 'block'; 
                });
                
                // Auto-launch your Dashboard on start
                setTimeout(() => this.open('home'), 500);
            },

            renderDrawer() {
                const d = document.getElementById('app-drawer');
                Object.keys(this.apps).forEach(k => {
                    const app = this.apps[k];
                    d.innerHTML += `
                        <div class="drawer-item" onclick="OS.open('${k}')">
                            <i class="material-icons-round" style="font-size:32px; color:${app.color}">${app.icon}</i>
                            <span style="font-size:10px; color:#aaa; font-weight:bold;">${app.title}</span>
                        </div>`;
                });
            },

            toggleDrawer() {
                document.getElementById('app-drawer').classList.toggle('active');
            },

            open(id) {
                document.getElementById('app-drawer').classList.remove('active');
                const app = this.apps[id];
                const temp = document.getElementById('win-temp').content.cloneNode(true);
                const win = temp.querySelector('.window');
                
                // WINDOW SETUP
                win.id = `win-${Date.now()}`;
                win.style.zIndex = ++this.zIndex;
                win.style.width = '800px'; 
                win.style.height = '600px';
                win.style.top = (10 + Math.random()*5) + '%';
                win.style.left = (15 + Math.random()*5) + '%';
                
                win.querySelector('.win-title').innerText = app.title;
                
                // CONTENT LOADING
                const content = win.querySelector('.win-content');
                if(app.type === 'widget') {
                    content.innerHTML += this.getWidget(app.code);
                } else {
                    // This loads your uploaded HTML files
                    content.innerHTML += `<iframe src="${app.url}"></iframe>`;
                }

                // CONTROLS
                win.querySelector('.close-btn').onclick = () => win.remove();
                win.querySelector('.max-btn').onclick = () => {
                    win.style.top = '0'; win.style.left = '0'; win.style.width = '100%'; win.style.height = '100%';
                };
                
                // FOCUS & DRAG
                win.onmousedown = () => { win.style.zIndex = ++this.zIndex; };
                this.makeDraggable(win);
                document.getElementById('desktop').appendChild(win);
            },

            makeDraggable(el) {
                const bar = el.querySelector('.win-bar');
                let isDrag = false, startX, startY, initX, initY;
                
                bar.onmousedown = (e) => {
                    isDrag = true;
                    el.classList.add('dragging'); // Shield activates to cover iframes
                    el.style.zIndex = ++this.zIndex;
                    startX = e.clientX; startY = e.clientY;
                    initX = el.offsetLeft; initY = el.offsetTop;
                    
                    document.onmousemove = (e) => {
                        if(!isDrag) return;
                        el.style.left = (initX + e.clientX - startX) + 'px';
                        el.style.top = (initY + e.clientY - startY) + 'px';
                    };
                    
                    document.onmouseup = () => {
                        isDrag = false;
                        el.classList.remove('dragging'); // Shield deactivates
                        document.onmousemove = null;
                        document.onmouseup = null;
                    };
                };
            },

            getWidget(code) {
                if(code === 'calc') return `<div style="padding:20px; color:white; text-align:center;">Simple Calculator Placeholder</div>`;
                if(code === 'todo') return `<div style="padding:20px; color:white;">Task List Placeholder</div>`;
            }
        };
    </script>
</body>
</html>
