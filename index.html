<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zenith OS | Sidebar v8</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #050505; --accent: #4285F4; --term: #00FF41; --red: #E50914; --sidebar: #0a0a0a; --win: #111; }
        body { margin: 0; background: var(--bg); font-family: 'Inter', sans-serif; color: white; overflow: hidden; height: 100vh; display: flex; }
        
        /* Sidebar Styles */
        #sidebar { width: 70px; background: var(--sidebar); border-right: 1px solid #222; display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 25px; z-index: 2000; }
        .side-icon { cursor: pointer; color: #444; transition: 0.3s; }
        .side-icon:hover { color: var(--accent); transform: scale(1.1); }
        .side-icon.active { color: var(--accent); }

        /* Main Workspace */
        #workspace { flex-grow: 1; position: relative; overflow: hidden; }
        #desktop { padding: 40px; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 30px; }
        
        .icon { width: 90px; display: flex; flex-direction: column; align-items: center; cursor: pointer; text-align: center; transition: 0.2s; }
        .icon:hover { transform: translateY(-5px); filter: drop-shadow(0 0 8px var(--accent)); }
        .icon i { font-size: 48px; color: var(--red); margin-bottom: 8px; }
        .icon span { font-size: 9px; font-weight: 900; color: #777; text-transform: uppercase; }

        /* Windows */
        .window { position: absolute; background: var(--win); border-radius: 12px; border: 1px solid #333; display: none; flex-direction: column; overflow: hidden; box-shadow: 0 40px 80px rgba(0,0,0,0.8); z-index: 10; }
        .win-bar { height: 40px; background: #000; display: flex; align-items: center; padding: 0 15px; cursor: move; }
        .win-title { flex-grow: 1; font-size: 10px; font-weight: 900; color: #555; letter-spacing: 1px; }

        /* Admin UI */
        .admin-body { flex-grow: 1; background: #020202; padding: 20px; font-family: 'JetBrains Mono'; color: var(--term); overflow-y: auto; }
        .admin-input { background: #111; border: 1px solid #222; color: var(--term); padding: 8px; width: 85%; margin-top: 5px; outline: none; }
        .inject-btn { background: var(--term); color: black; border: none; width: 100%; padding: 10px; margin-top: 10px; font-weight: bold; cursor: pointer; }

        /* Taskbar */
        #taskbar { position: absolute; bottom: 0; left: 70px; right: 0; height: 45px; background: #000; border-top: 1px solid #222; display: flex; align-items: center; padding: 0 20px; z-index: 1000; }
        #q-search { background: #111; border: 1px solid #333; color: white; padding: 5px 15px; border-radius: 20px; width: 250px; outline: none; font-size: 12px; }
        #clock { margin-left: auto; font-family: 'JetBrains Mono'; font-size: 11px; color: #555; }

        #panic { position: fixed; inset: 0; background: white; z-index: 99999; display: none; }
    </style>
</head>
<body onload="initOS()">

    <div id="panic"><iframe src="https://classroom.google.com" style="width:100%;height:100%;border:none;"></iframe></div>

    <div id="sidebar">
        <i class="material-icons-round side-icon" onclick="openWin('admin-win')" title="Admin">terminal</i>
        <i class="material-icons-round side-icon" onclick="openWin('web-win')" title="Browser">language</i>
        <i class="material-icons-round side-icon" onclick="location.reload()" title="Refresh">refresh</i>
        <i class="material-icons-round side-icon" style="margin-top:auto; margin-bottom:20px; color:var(--red);" onclick="document.getElementById('panic').style.display='block'" title="Panic">power_settings_new</i>
    </div>

    <div id="workspace">
        <div id="desktop">
            </div>

        <div id="cinema-win" class="window" style="width: 1000px; height: 600px; top: 50px; left: 50px;">
            <div class="win-bar" onmousedown="focusWin('cinema-win');dragWin(event, 'cinema-win')">
                <div class="win-title" id="c-label">ZENITH_CINEMA</div>
                <i class="material-icons-round" onclick="closeWin('cinema-win')" style="cursor:pointer; font-size:18px;">close</i>
            </div>
            <iframe id="c-frame" src="" style="flex-grow:1; border:none; background:#000;"></iframe>
        </div>

        <div id="web-win" class="window" style="width: 900px; height: 600px; top: 80px; left: 100px;">
            <div class="win-bar" onmousedown="focusWin('web-win');dragWin(event, 'web-win')">
                <div class="win-title">SECURE_BROWSER</div>
                <i class="material-icons-round" onclick="closeWin('web-win')" style="cursor:pointer; font-size:18px;">close</i>
            </div>
            <iframe id="web-frame" src="https://www.google.com/search?igu=1" style="flex-grow:1; border:none;"></iframe>
        </div>

        <div id="admin-win" class="window" style="width: 400px; height: 500px; top: 120px; left: 150px;">
            <div class="win-bar" onmousedown="focusWin('admin-win');dragWin(event, 'admin-win')">
                <div class="win-title">SYSTEM_CORE</div>
                <i class="material-icons-round" onclick="closeWin('admin-win')" style="cursor:pointer; font-size:18px;">close</i>
            </div>
            <div id="a-login" class="admin-body">
                <div>> AUTH_KEY: (Ck0)</div>
                <input type="password" id="u-in" class="admin-input">
            </div>
            <div id="a-panel" class="admin-body" style="display:none;">
                <div>> CLOUD_INJECTOR:</div>
                <input type="text" id="s-id" class="admin-input" placeholder="Google Drive Folder ID">
                <button onclick="verifyFolder()" style="margin-top:10px; cursor:pointer;">VERIFY ID</button>
                <input type="text" id="s-name" class="admin-input" placeholder="Show Name">
                <button class="inject-btn" onclick="saveShow()">PUSH TO FIREBASE</button>
                <div id="cloud-list" style="margin-top:20px; border-top:1px solid #333;"></div>
            </div>
        </div>

        <div id="taskbar">
            <input type="text" id="q-search" placeholder="Search Google..." onkeypress="if(event.key==='Enter') qNav()">
            <div id="clock">00:00:00</div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDQmlHngYNWqAbveDkUCiuIdgN1ZnnZ2ng",
            authDomain: "titan-84c56.firebaseapp.com",
            projectId: "titan-84c56",
            storageBucket: "titan-84c56.firebasestorage.app",
            messagingSenderId: "869990600595",
            appId: "1:869990600595:web:6181d38e40e5102a9ae266",
            databaseURL: "https://titan-84c56-default-rtdb.firebaseio.com"
        };
        const DRIVE_KEY = "AIzaSyDQmlHngYNWqAbveDkUCiuIdgN1ZnnZ2ng";

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const showsRef = ref(db, 'shows');

        window.saveShow = () => {
            const n = document.getElementById('s-name').value;
            const i = document.getElementById('s-id').value;
            if(n && i) push(showsRef, { name: n, folderId: i });
        };

        window.verifyFolder = async () => {
            const id = document.getElementById('s-id').value;
            const res = await fetch(`https://www.googleapis.com/drive/v3/files/${id}?key=${DRIVE_KEY}`);
            const data = await res.json();
            if(data.name) document.getElementById('s-name').value = data.name;
        };

        onValue(showsRef, (snapshot) => {
            const data = snapshot.val();
            document.querySelectorAll('.drive-show').forEach(e => e.remove());
            document.getElementById('cloud-list').innerHTML = "";
            if (data) {
                Object.entries(data).forEach(([key, show]) => {
                    const d = document.createElement('div');
                    d.className = "icon drive-show";
                    d.onclick = () => {
                        document.getElementById('c-frame').src = `https://drive.google.com/embeddedfolderview?id=${show.folderId}#grid`;
                        document.getElementById('c-label').innerText = show.name.toUpperCase();
                        openWin('cinema-win');
                    };
                    d.innerHTML = `<i class="material-icons-round">play_circle_filled</i><span>${show.name}</span>`;
                    document.getElementById('desktop').appendChild(d);

                    // Admin list item
                    const item = document.createElement('div');
                    item.style = "display:flex; justify:space-between; padding:5px; font-size:10px;";
                    item.innerHTML = `<span>${show.name}</span> <span style="color:red; cursor:pointer" onclick="delShow('${key}')">[DEL]</span>`;
                    document.getElementById('cloud-list').appendChild(item);
                });
            }
        });

        window.delShow = (key) => remove(ref(db, `shows/${key}`));
    </script>

    <script>
        let zIndex = 100;
        function initOS() {
            setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);
            document.addEventListener('keydown', e => { if(e.key === '`') document.getElementById('panic').style.display = 'block'; });
            document.getElementById('u-in').onkeypress = (e) => {
                if(e.key === 'Enter' && e.target.value === 'Ck0') {
                    document.getElementById('a-login').style.display = 'none';
                    document.getElementById('a-panel').style.display = 'block';
                }
            };
        }
        function openWin(id) { focusWin(id); document.getElementById(id).style.display = 'flex'; }
        function closeWin(id) { document.getElementById(id).style.display = 'none'; }
        function focusWin(id) { zIndex++; document.getElementById(id).style.zIndex = zIndex; }
        function qNav() {
            const v = document.getElementById('q-search').value;
            openWin('web-win');
            document.getElementById('web-frame').src = 'https://www.google.com/search?q=' + v + '&igu=1';
        }
        function dragWin(e, id) {
            const w = document.getElementById(id);
            let ox = e.clientX - w.offsetLeft, oy = e.clientY - w.offsetTop;
            const m = ev => { w.style.left = ev.clientX - ox + 'px'; w.style.top = ev.clientY - oy + 'px'; };
            document.addEventListener('mousemove', m);
            document.onmouseup = () => document.removeEventListener('mousemove', m);
        }
    </script>
</body>
</html>
